var documenterSearchIndex = {"docs":
[{"location":"APIs/#APIs","page":"APIs","title":"APIs","text":"There are 6 functions that are exported, namely\n\nTeukolsky_radial\nGSN_radial\nTeukolsky_pointparticle_mode\nGSN_pointparticle_mode\nrstar_from_r\nr_from_rstar\n\nand there are 7 custom types that are exported, i.e.\n\nBoundaryCondition\nNormalizationConvention\nMode\nGSNRadialFunction\nTeukolskyRadialFunction\nGSNPointParticleMode\nTeukolskyPointParticleMode\n\nCurrently, only the exported functions and types are documented below. Documentations for private (i.e. unexported) functions will be added at a later stage.","category":"section"},{"location":"APIs/#Functions","page":"APIs","title":"Functions","text":"","category":"section"},{"location":"APIs/#Types","page":"APIs","title":"Types","text":"","category":"section"},{"location":"APIs/#BoundaryCondition","page":"APIs","title":"BoundaryCondition","text":"This is an enum type that can take either one of the four values\n\nvalue \nIN purely ingoing at the horizon\nUP purely outgoing at infinity\nOUT purely outgoing at the horizon\nDOWN purely ingoing at infinity","category":"section"},{"location":"APIs/#NormalizationConvention","page":"APIs","title":"NormalizationConvention","text":"This is an enum type that can take either one of the two values\n\nvalue \nUNIT_GSN_TRANS normalized to have a unit transmission amplitude for the GSN function\nUNIT_TEUKOLSKY_TRANS normalized to have a unit transmission amplitude for the Teukolsky function","category":"section"},{"location":"APIs/#Mode","page":"APIs","title":"Mode","text":"This is a composite struct type that stores information about a mode\n\nfield \ns spin weight s\nl harmonic index ell\nm azimuthal index m\na Kerr spin parameter aM\nomega frequency Momega\nlambda spin-weighted spheroidal eigenvalue lambda","category":"section"},{"location":"APIs/#GSNRadialFunction","page":"APIs","title":"GSNRadialFunction","text":"This is a composite struct type that stores the output from GSN_radial\n\ntip: Tip\nGSNRadialFunction(rstar) is equivalent to GSNRadialFunction.GSN_solution(rstar)[1],  returning only the value of the GSN function evaluated at the tortoise coordinate rstar\n\nfield \nmode a Mode object storing information about the mode\nboundary_condition a BoundaryCondition object storing which boundary condition this function satisfies\nrsin numerical inner boundary r_*^mathrminM where the GSN equation is numerically evolved (r_* is a tortoise coordinate)\nrsout numerical outer boundary r_*^mathrmoutM where the GSN equation is numerically evolved (r_* is a tortoise coordinate)\nrsmp The matching point in tortoise coordinate r_*^mathrmmp if used\nhorizon_expansion_order order of the asymptotic expansion at the horizon\ninfinity_expansion_order order of the asymptotic expansion at infinity\ntransmission_amplitude transmission amplitude in the GSN formalism of this function\nincidence_amplitude incidence amplitude in the GSN formalism of this function\nreflection_amplitude reflection amplitude in the GSN formalism of this function\nnumerical_GSN_solution numerical solution (ODESolution object from DifferentialEquations.jl) to the GSN equation in [rsin, rsout] if applicable; output is a vector  hatX(r_*) dhatX(r_*)dr_* \nnumerical_Riccati_solution numerical solution (ODESolution object from DifferentialEquations.jl) to the GSN equation in the Riccati form if applicable; output is a vector  hatPhi(r_*) dhatPhi(r_*)dr_* \nGSN_solution full GSN solution where asymptotic solutions are smoothly attached; output is a vector  hatX(r_*) dhatX(r_*)dr_* \nnormalization_convention a NormalizationConvention object storing which normalization convention this function adheres to","category":"section"},{"location":"APIs/#TeukolskyRadialFunction","page":"APIs","title":"TeukolskyRadialFunction","text":"This is a composite struct type that stores the output from Teukolsky_radial\n\ntip: Tip\nTeukolskyRadialFunction(r) is equivalent to TeukolskyRadialFunction.Teukolsky_solution(r)[1],  returning only the value of the Teukolsky function evaluated at the Boyer-Lindquist coordinate r\n\nfield \nmode a Mode object storing information about the mode\nboundary_condition a BoundaryCondition object storing which boundary condition this function satisfies\ntransmission_amplitude transmission amplitude in the Teukolsky formalism of this function\nincidence_amplitude incidence amplitude in the Teukolsky formalism of this function\nreflection_amplitude reflection amplitude in the Teukolsky formalism of this function\nGSN_solution a GSNRadialFunction object storing the corresponding GSN function\nTeukolsky_solution Teukolsky solution where asymptotic solutions are smoothly attached; output is a vector  hatR(r) dhatR(r)dr \nnormalization_convention a NormalizationConvention object storing which normalization convention this function adheres to","category":"section"},{"location":"APIs/#GSNPointParticleMode","page":"APIs","title":"GSNPointParticleMode","text":"This is a composite struct type that stores the output from GSN_pointparticle_mode\n\nfield \nmode a Mode object storing information about the mode (including the frequency)\namplitude_inf the amplitude of the inhomogeneous GSN solution at infinity such that X^infty_ell m omega =  amplitude_inf  times e^i omega r_*\nenergy_flux_inf the energy flux emitted towards infinity\nangular_momentum_flux_inf the angular momentum flux towards infinity\nCarter_const_flux_inf the Carter constant flux towards infinity\ntrajectory the trajectory/geodesic that the particle follows\nY_solution the auxiliary function Y used in the calculation\nSWSH the spin-weighted spheroidal harmonic` used in the calculation\nmethod a named tuple storing the method and grid size used in computing the convolution integral","category":"section"},{"location":"APIs/#TeukolskyPointParticleMode","page":"APIs","title":"TeukolskyPointParticleMode","text":"This is a composite struct type that stores the output from Teukolsky_pointparticle_mode\n\nfield \nmode a Mode object storing information about the mode (including the frequency)\namplitude_inf the amplitude of the inhomogeneous Teukolsky solution at infinity such that R^infty_ell m omega =  amplitude_inf  times r^-(2s+1) e^i omega r_*\nenergy_flux_inf the energy flux emitted towards infinity\nangular_momentum_flux_inf the angular momentum flux towards infinity\nCarter_const_flux_inf the Carter constant flux towards infinity\ntrajectory the trajectory/geodesic that the particle follows\nY_solution the auxiliary function Y used in the calculation\nSWSH the spin-weighted spheroidal harmonic` used in the calculation\nmethod a named tuple storing the method and grid size used in computing the convolution integral","category":"section"},{"location":"APIs/#GeneralizedSasakiNakamura.Teukolsky_radial","page":"APIs","title":"GeneralizedSasakiNakamura.Teukolsky_radial","text":"Teukolsky_radial(s::Int, l::Int, m::Int, a, omega, boundary_condition, rsin, rsout; horizon_expansion_order::Int=_DEFAULT_horizon_expansion_order, infinity_expansion_order::Int=_DEFAULT_infinity_expansion_order, method=\"auto\", data_type=Solutions._DEFAULTDATATYPE,  ODE_algorithm=Solutions._DEFAULTSOLVER, tolerance=Solutions._DEFAULTTOLERANCE, rsmp=nothing)\n\nCompute the Teukolsky function for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, a the Kerr spin parameter, and omega the frequency [which can be complex])  and boundary condition specified by boundary_condition, which can be either\n\n- `IN` for purely-ingoing at the horizon,\n- `UP` for purely-outgoing at infinity,\n- `OUT` for purely-outgoing at the horizon,\n- `DOWN` for purely-ingoing at infinity.\n\nNote that the OUT and DOWN solutions are constructed by linearly combining the IN and UP solutions, respectively.\n\nThe full GSN solution is converted to the corresponding Teukolsky solution (R(r) dRdr) and  the incidence, reflection and transmission amplitude are converted from the GSN formalism to the Teukolsky formalism  with the normalization convention that the transmission amplitude is normalized to 1 (i.e. normalization_convention=UNIT_TEUKOLSKY_TRANS).\n\nNote, however, when omega = 0, the exact Teukolsky function expressed using Gauss hypergeometric functions will be returned (i.e., instead of using the GSN formalism).  In this case, only s, l, m, a, omega, boundary_condition will be parsed.\n\nWith complex values of omega, the Teukolsky function is evaluated as a function of r, where the value at the corresponding location rho = r_*(r) in mathbbR along the rotated integration path on the complex plane is returned.\n\n\n\n\n\nTeukolsky_radial(s::Int, l::Int, m::Int, a, omega; data_type=Solutions._DEFAULTDATATYPE, ODE_algorithm=Solutions._DEFAULTSOLVER, tolerance=Solutions._DEFAULTTOLERANCE, method=\"auto\")\n\nCompute the Teukolsky function for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, a the Kerr spin parameter, and omega the frequency) with the purely-ingoing boundary condition at the horizon (IN) and the purely-outgoing boundary condition at infinity (UP).\n\nNote that for real frequencies, the numerical inner boundary (rsin) and outer boundary (rsout) are set to the default values _DEFAULT_rsin and _DEFAULT_rsout, respectively, while the order of the asymptotic expansion at the horizon and infinity are determined automatically. As for complex frequencies, the numerical inner and the outer boundaries are determined automatically, while the order of the asymptotic expansion at the horizon and infinity are set to _DEFAULT_horizon_expansion_order_for_cplx_freq and _DEFAULT_infinity_expansion_order_for_cplx_freq, respectively.\n\n\n\n\n\n","category":"function"},{"location":"APIs/#GeneralizedSasakiNakamura.GSN_radial","page":"APIs","title":"GeneralizedSasakiNakamura.GSN_radial","text":"GSN_radial(s::Int, l::Int, m::Int, a, omega, boundary_condition, rsin, rsout; horizon_expansion_order::Int=_DEFAULT_horizon_expansion_order, infinity_expansion_order::Int=_DEFAULT_infinity_expansion_order, method=\"auto\", data_type=Solutions._DEFAULTDATATYPE,  ODE_algorithm=Solutions._DEFAULTSOLVER, tolerance=Solutions._DEFAULTTOLERANCE, rsmp=nothing)\n\nCompute the GSN function for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, a the Kerr spin parameter, and omega the frequency [which can be complex])  and boundary condition specified by boundary_condition, which can be either\n\n- `IN` for purely-ingoing at the horizon,\n- `UP` for purely-outgoing at infinity,\n- `OUT` for purely-outgoing at the horizon,\n- `DOWN` for purely-ingoing at infinity.\n\nNote that the OUT and DOWN solutions are constructed by linearly combining the IN and UP solutions, respectively.\n\nThe GSN function is numerically solved, for real values of omega, in the interval of tortoise coordinates r_* in [rsin, rsout] using the ODE solver (from DifferentialEquations.jl) specified by ODE_algorithm (default: Vern9())  with tolerance specified by tolerance (default: 1e-12). The ODE to be solved is determined by the keyword method (default: auto), which can be either linear (solving the GSN equation in a linear form) or Riccati (solving the GSN equation in a nonlinear form). By default the data type used is ComplexF64 (i.e. double-precision floating-point number) but it can be changed by specifying data_type (e.g. Complex{BigFloat} for complex arbitrary precision number).\n\nWith complex values of omega, the GSN function is solved along a rotated path on the complex plane of r_*,  where the path consists of two broken line segments parametrized by a real variable/a new coordinate rho. The angle with which the path is rotated is determined by the frequency omega, the Kerr spin parameter a and the azimuthal index m,  such that the GSN function still behaves like a plane wave near the horizon and spatial infinity.  At rho = 0, the path intersects with the real axis at r_* = r_*^rmmp (rsmp, default to be nothing, which means it will be determined automatically). Both the numerical and semi-analytical GSN solutions are evaluated as functions of rho instead of the now-complex r_*.\n\nWhile the numerical GSN solution is only accurate in the range [rsin, rsout],  the full GSN solution is constructed by smoothly attaching the asymptotic solutions near horizon (up to horizon_expansion_order-th order)  and infinity (up to infinity_expansion_order-th order). Therefore, the now-semi-analytical GSN solution is accurate everywhere.\n\nNote, however, when omega = 0, the exact GSN function expressed using Gauss hypergeometric functions will be returned (i.e., instead of being solved numerically).  In this case, only s, l, m, a, omega, boundary_condition will be parsed.\n\nReturn a GSNRadialFunction object which contains all the information about the GSN solution.\n\n\n\n\n\nGSN_radial(s::Int, l::Int, m::Int, a, omega; data_type=Solutions._DEFAULTDATATYPE, ODE_algorithm=Solutions._DEFAULTSOLVER, tolerance=Solutions._DEFAULTTOLERANCE, method=\"auto\")\n\nCompute the GSN function for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, a the Kerr spin parameter, and omega the frequency) with the purely-ingoing boundary condition at the horizon (IN) and the purely-outgoing boundary condition at infinity (UP).\n\nNote that for real frequencies, the numerical inner boundary (rsin) and outer boundary (rsout) are set to the default values _DEFAULT_rsin and _DEFAULT_rsout, respectively, while the order of the asymptotic expansion at the horizon and infinity are determined automatically. As for complex frequencies, the numerical inner and the outer boundaries are determined automatically, while the order of the asymptotic expansion at the horizon and infinity are set to _DEFAULT_horizon_expansion_order_for_cplx_freq and _DEFAULT_infinity_expansion_order_for_cplx_freq, respectively.\n\n\n\n\n\n","category":"function"},{"location":"APIs/#GeneralizedSasakiNakamura.Coordinates.rstar_from_r","page":"APIs","title":"GeneralizedSasakiNakamura.Coordinates.rstar_from_r","text":"rstar_from_r(a, r)\n\nConvert a Boyer-Lindquist coordinate r to the corresponding tortoise coordinate rstar.\n\n\n\n\n\n","category":"function"},{"location":"APIs/#GeneralizedSasakiNakamura.Coordinates.r_from_rstar","page":"APIs","title":"GeneralizedSasakiNakamura.Coordinates.r_from_rstar","text":"r_from_rstar(a, rstar)\n\nConvert a tortoise coordinate rstar to the corresponding Boyer-Lindquist coordiante r.  It uses a bisection method when rstar <= 0, and Newton method otherwise.\n\nThe function assumes that r geq r_+ where r_+ is the outer event horizon.\n\n\n\n\n\n","category":"function"},{"location":"APIs/#GeneralizedSasakiNakamura.Teukolsky_pointparticle_mode","page":"APIs","title":"GeneralizedSasakiNakamura.Teukolsky_pointparticle_mode","text":"Teukolsky_pointparticle_mode(s::Int, l::Int, m::Int, n::Int, k::Int, a, p, e, x; method=\"auto\", N::Int, K::Int)\n\nCompute the amplitude of the inhomogeneous Teukolsky solution at infinity due to a point particle on a generic timelike bound orbit around a Kerr black hole, with a spin parameter of a, for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, n the radial index and k the polar index). The orbit is specified by p the semi-letus rectum, e the eccentricity and x the inclination parameter (x equiv cos theta_mathrminc).\n\nIn addition, we compute also the energy, angular momentum and Carter constant flux at infinity. Note that these values are formalism-independent.\n\nThe numerical method to compute the convolution integral is specified by method (default: auto), which can either be trapezoidal or levin. We sample the trajectory over a grid of size N x K, where N and K are the number of Chebyshev nodes in the radial and the polar direction, respectively. Note that they must be powers of 2.\n\n\n\n\n\n","category":"function"},{"location":"APIs/#GeneralizedSasakiNakamura.GSN_pointparticle_mode","page":"APIs","title":"GeneralizedSasakiNakamura.GSN_pointparticle_mode","text":"GSN_pointparticle_mode(s::Int, l::Int, m::Int, n::Int, k::Int, a, p, e, x; method=\"auto\", N::Int, K::Int)\n\nCompute the amplitude of the inhomogeneous GSN solution at infinity due to a point particle on a generic timelike bound orbit around a Kerr black hole, with a spin parameter of a, for a given mode (specified by s the spin weight, l the harmonic index, m the azimuthal index, n the radial index and k the polar index). The orbit is specified by p the semi-letus rectum, e the eccentricity and x the inclination parameter (x equiv cos theta_mathrminc).\n\nIn addition, we compute also the energy, angular momentum and Carter constant flux at infinity. Note that these values are formalism-independent.\n\nThe numerical method to compute the convolution integral is specified by method (default: auto), which can either be trapezoidal or levin. We sample the trajectory over a grid of size N x K, where N and K are the number of Chebyshev nodes in the radial and the polar direction, respectively. Note that they must be powers of 2.\n\n\n\n\n\n","category":"function"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"Pages = [\"examples.md\"]","category":"section"},{"location":"examples/#Example-1:-Solving-and-visualizing-some-Teukolsky-and-GSN-functions","page":"Examples","title":"Example 1: Solving and visualizing some Teukolsky and GSN functions","text":"In this example, we solve for the Teukolsky and the GSN function with s = -2 ell = 2 m = 2 a = 07 omega = 025 that satisfy the purely outgoing condition at infinity (i.e. UP).\n\nusing GeneralizedSasakiNakamura\nusing Plots, LaTeXStrings\n\n# Specify which mode and what boundary condition\ns=-2; l=2; m=2; a=0.7; omega=0.25; bc=UP; # Change to bc=IN to solve for R^in or X^in instead\n# Specify where to match to ansatzes\nrsin=-20; rsout=250;\n\n# NOTE: julia uses 'just-ahead-of-time' compilation. Calling this the first time in each session will take some time\nR = Teukolsky_radial(s, l, m, a, omega, bc, rsin, rsout);\n\n# Set up a grid of the tortoise coordinate rs\nrsgrid = collect(-30:1:300); # Does not have to be within [rsin, rsout]\n# Set up a grid of the Boyer-Lindquist r coordinate\n# Convert from rsgrid using r_from_rstar(a, rs)\nrgrid = [r_from_rstar(a, rs) for rs in rsgrid];\n\n# Visualize the Teukolsky function\n\n# Use the 'shortcut' interface to access the function\nplot(rgrid, [real(R(r)) for r in rgrid], label=\"real\")\n# Use the full interface to access the function (and its derivative)\nplot!(rgrid, [imag(R.Teukolsky_solution(r)[1]) for r in rgrid], label=\"imag\")\nplot!(\n    legendfontsize=14,\n    xguidefontsize=14,\n    yguidefontsize=14,\n    xtickfontsize=14,\n    ytickfontsize=14,\n    foreground_color_legend=nothing,\n    background_color_legend=nothing,\n    legend=:topleft,\n    xlabel=L\"r/M\",\n    ylabel=L\"R(r)\",\n)\ntitle!(\"$(R.boundary_condition) solution\")\n\n(Image: R.png)\n\n# Visualize the underlying GSN function\n\n# Use the 'shortcut' interface to access the function\nplot(rsgrid, [real(R.GSN_solution(rs)) for rs in rsgrid], label=\"real\")\n# Use the full interface to access the function (and its derivative)\nplot!(rsgrid, [imag(R.GSN_solution.GSN_solution(rs)[1]) for rs in rsgrid], label=\"imag\")\nplot!(\n    legendfontsize=14,\n    xguidefontsize=14,\n    yguidefontsize=14,\n    xtickfontsize=14,\n    ytickfontsize=14,\n    foreground_color_legend=nothing,\n    background_color_legend=nothing,\n    legend=:bottomright,\n    xlabel=L\"r_{*}/M\",\n    ylabel=L\"X(r_{*})\",\n)\ntitle!(\"$(R.boundary_condition) solution\")\n\n(Image: X.png)\n\n# Visualize the underlying complex frequency function\n# NOTE: for this one, rstar has to be within [rsin, rsout]\nplot(collect(rsin:0.1:rsout), [real(R.GSN_solution.numerical_Riccati_solution(rs)[2]) for rs in rsin:0.1:rsout], label=\"real\")\n# Use the full interface to access the function (and its derivative)\nplot!(collect(rsin:0.1:rsout), [imag(R.GSN_solution.numerical_Riccati_solution(rs)[2]) for rs in rsin:0.1:rsout], label=\"imag\")\nplot!(\n    legendfontsize=14,\n    xguidefontsize=14,\n    yguidefontsize=14,\n    xtickfontsize=14,\n    ytickfontsize=14,\n    foreground_color_legend=nothing,\n    background_color_legend=nothing,\n    legend=:bottomright,\n    xlabel=L\"r_{*}/M\",\n    ylabel=L\"d\\Phi(r_{*})/dr_{*}\",\n)\ntitle!(\"$(R.boundary_condition) solution\")\n\n(Image: dPhidrs.png)","category":"section"},{"location":"examples/#Example-2:-Plotting-reflectivity-of-black-holes-(in-GSN-formalism)","page":"Examples","title":"Example 2: Plotting reflectivity of black holes (in GSN formalism)","text":"using GeneralizedSasakiNakamura\nusing Plots, LaTeXStrings\n\nsarr = [-2, -1, 0, 1, 2];\nl=2;m=2;a=0.0;\nreflectivity_from_inf_nonrotating = Dict()\nomegas = collect(0.01:0.01:2.0);\n\nfor s in sarr\n    reflectivity_from_inf_nonrotating[s] = []\n    for omg in omegas\n        Xin = GSN_radial(s, l, m, a, omg, IN, -20, 250)\n        append!(reflectivity_from_inf_nonrotating[s], Xin.reflection_amplitude/Xin.incidence_amplitude)\n    end\nend\n\nplot(omegas, abs.(reflectivity_from_inf_nonrotating[-2]), linewidth=2, color=theme_palette(:auto)[1], label=L\"s = \\pm 2\")\nplot!(omegas, abs.(reflectivity_from_inf_nonrotating[-1]), linewidth=2, color=theme_palette(:auto)[2], label=L\"s = \\pm 1\")\nplot!(omegas, abs.(reflectivity_from_inf_nonrotating[0]), linewidth=2, color=theme_palette(:auto)[3], label=L\"s = 0\")\nplot!(\n    legendfontsize=14,\n    xguidefontsize=14,\n    yguidefontsize=14,\n    xtickfontsize=14,\n    ytickfontsize=14,\n    foreground_color_legend=nothing,\n    background_color_legend=nothing,\n    legend=:bottomright,\n    formatter=:latex,\n    xlabel=L\"M\\omega\",\n    ylabel=L\"| \\hat{B}^{\\mathrm{ref}}_{\\mathrm{SN}}/\\hat{B}^{\\mathrm{inc}}_{\\mathrm{SN}} |\",\n    left_margin = 2Plots.mm,\n    right_margin = 3Plots.mm,\n)\ntitle!(L\"a/M = 0\")\n\n(Image: reflectivity-aOverM_0.png)\n\nsarr = [-2, -1, 0, 1, 2];\nl=2;m=2;a=0.7;\nreflectivity_from_inf_rotating = Dict()\nomegas = collect(0.01:0.01:2.0);\n\nfor s in sarr\n    reflectivity_from_inf_rotating[s] = []\n    for omg in omegas\n        Xin = GSN_radial(s, l, m, a, omg, IN, -20, 250)\n        append!(reflectivity_from_inf_rotating[s], Xin.reflection_amplitude/Xin.incidence_amplitude)\n    end\nend\n\nplot(omegas, abs.(reflectivity_from_inf_rotating[-2]), linewidth=2, color=theme_palette(:auto)[1], label=L\"s = -2\")\nplot!(omegas, abs.(reflectivity_from_inf_rotating[-1]), linewidth=2, color=theme_palette(:auto)[2], label=L\"s = -1\")\nplot!(omegas, abs.(reflectivity_from_inf_rotating[0]), linewidth=2, color=theme_palette(:auto)[3], label=L\"s = 0\")\nplot!(omegas, abs.(reflectivity_from_inf_rotating[1]), linewidth=2, color=theme_palette(:auto)[4], label=L\"s = 1\")\nplot!(omegas, abs.(reflectivity_from_inf_rotating[2]), linewidth=2, color=theme_palette(:auto)[5], label=L\"s = 2\")\nplot!(\n    legendfontsize=14,\n    xguidefontsize=14,\n    yguidefontsize=14,\n    xtickfontsize=14,\n    ytickfontsize=14,\n    foreground_color_legend=nothing,\n    background_color_legend=nothing,\n    legend=:bottomright,\n    formatter=:latex,\n    xlabel=L\"M\\omega\",\n    ylabel=L\"| \\hat{B}^{\\mathrm{ref}}_{\\mathrm{SN}}/\\hat{B}^{\\mathrm{inc}}_{\\mathrm{SN}} |\",\n    left_margin = 2Plots.mm,\n    right_margin = 3Plots.mm,\n)\ntitle!(L\"a/M = 0.7\")\n\n(Image: reflectivity-aOverM_0p7.png)","category":"section"},{"location":"#Home","page":"Home","title":"Home","text":"GeneralizedSasakiNakamura.jl computes solutions to the frequency-domain radial Teukolsky equation with the Generalized Sasaki-Nakamura (GSN) formalism.\n\nThe code is capable of handling both ingoing and outgoing radiation of scalar, electromagnetic, and gravitational type (corresponding to spin weight of s = 0 pm 1 pm 2 respectively).\n\nThe angular Teukolsky equation is solved with an accompanying julia package SpinWeightedSpheroidalHarmonics.jl using a spectral decomposition method.\n\nBoth codes are capable of handling complex frequencies, and we use M = 1 convention throughout.\n\nThe paper describing both the GSN formalism and the implementation can be found in 2306.16469. A set of Mathematica notebooks deriving all the equations used in the code can be found in 10.5281/zenodo.8080241.\n\nStarting from v0.7.0, the code is also capable of computing the gravitational waveform and fluxes at infinity due a test particle orbiting around a Kerr black hole in a generic (eccentric, inclined) timelike bound orbit by solving the inhomogeneous SN equation using integration by parts.","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"To install the package using the Julia package manager, simply type the following in the Julia REPL:\n\nusing Pkg\nPkg.add(\"GeneralizedSasakiNakamura\")\n\nNote: There is no need to install SpinWeightedSpheroidalHarmonics.jl separately as it should be automatically installed by the package manager.","category":"section"},{"location":"#Highlights","page":"Home","title":"Highlights","text":"","category":"section"},{"location":"#Performant-frequency-domain-Teukolsky-solver","page":"Home","title":"Performant frequency-domain Teukolsky solver","text":"Works well at both low and high frequencies, and takes only a few tens of milliseconds on average:\n\n<table>\n  <tr>\n    <th>GeneralizedSasakiNakamura.jl</th>\n    <th><a href=\"https://github.com/BlackHolePerturbationToolkit/Teukolsky\">Teukolsky</a> Mathematica package using the MST method </th>\n  </tr>\n  <tr>\n    <td><p align=\"center\"><img width=\"100%\" src=\"https://github-production-user-asset-6210df.s3.amazonaws.com/55488840/248965077-7d216deb-5bae-433f-a699-d40a35f0e35d.gif\"></p></td>\n    <td><p align=\"center\"><img width=\"100%\" src=\"https://github-production-user-asset-6210df.s3.amazonaws.com/55488840/248966033-9e7d8027-81ee-4762-98d9-0ad0a1c030ad.gif\"></p></td>\n  </tr>\n</table>\n\n(There was no caching! We solved the equation on-the-fly! The notebook generating this animation can be found here)\n\nStatic/zero-frequency solutions are solved analytically with Gauss hypergeometric functions.","category":"section"},{"location":"#Solutions-that-are-accurate-everywhere","page":"Home","title":"Solutions that are accurate everywhere","text":"Numerical solutions are smoothly stitched to analytical ansatzes near the horizon and infinity at user-specified locations rsin and rsout respectively:\n\n<p align=\"center\">\n  <img width=\"50%\" src=\"https://github-production-user-asset-6210df.s3.amazonaws.com/55488840/248724944-9707332b-1238-4b3b-b1c0-ac426a1b3dc6.gif\">\n</p>","category":"section"},{"location":"#Easy-to-use","page":"Home","title":"Easy to use","text":"The following code snippet lets you solve the (source-free) Teukolsky function (in frequency domain) for the mode s=-2 ell=2 m=2 aM=07 Momega=05 that satisfies the purely-ingoing boundary condition at the horizon, R^textrmin, and the purely-outgoing boundary condition at spatial infinity, R^textrmup, respectively:\n\nusing GeneralizedSasakiNakamura # This is going to take some time to pre-compile, mostly due to DifferentialEquations.jl\n\n# Specify which mode to solve\ns=-2; l=2; m=2; a=0.7; omega=0.5;\n\n# NOTE: julia uses 'just-ahead-of-time' compilation. Calling this the first time in each session will take some time\nRin, Rup = Teukolsky_radial(s, l, m, a, omega)\n\nThat's it! If you run this on Julia REPL, it should give you something like this\n\n(TeukolskyRadialFunction(mode=Mode(s=-2, l=2, m=2, a=0.7, omega=0.5, lambda=1.696609401635342), boundary_condition=IN), TeukolskyRadialFunction(mode=Mode(s=-2, l=2, m=2, a=0.7, omega=0.5, lambda=1.696609401635342), boundary_condition=UP))\n\nIn Julia REPL, you can check out all the asymptotic amplitudes at a glimpse using something like\n\njulia> Rin\nTeukolskyRadialFunction(\n    mode=Mode(s=-2, l=2, m=2, a=0.7, omega=0.5, lambda=1.696609401635342),\n    boundary_condition=IN,\n    transmission_amplitude=1.0 + 0.0im,\n    incidence_amplitude=6.5365876612287765 - 4.9412038970871555im,\n    reflection_amplitude=-0.1282466191307726 - 0.440481334972911im,\n    normalization_convention=UNIT_TEUKOLSKY_TRANS\n)\n\nFor example, if we want to evaluate the Teukolsky function R^textrmin at the location r = 10M, simply do\n\nRin(10)\n\nThis should give\n\n77.57508416835319 - 429.40290952262677im","category":"section"},{"location":"#Solving-for-complex-frequencies","page":"Home","title":"Solving for complex frequencies","text":"One can use the same interface to compute solutions with complex frequencies. For example, the QNM solution of the s=-2 ell=2 m=2 aM=068 fundamental tone can be obtained using\n\nRin, Rup = Teukolsky_radial(-2, 2, 2, 0.68, 0.5239751-0.0815126im)\n\nWe can check out the R^textrmup solution using\n\njulia> Rup\nTeukolskyRadialFunction(\n    mode=Mode(s=-2, l=2, m=2, a=0.68, omega=0.5239751 - 0.0815126im, lambda=1.655003080578682 + 0.3602676563885877im),\n    boundary_condition=UP,\n    transmission_amplitude=1.0 + 0.0im,\n    incidence_amplitude=-5.850900444651249e-8 - 3.80716581300155e-7im,\n    reflection_amplitude=1.1011632133920028 + 2.1300597377432497im,\n    normalization_convention=UNIT_TEUKOLSKY_TRANS\n)\n\nWe see that the incidence amplitude is indeed very small numerically as a QNM solution should. This can be accessed using\n\nRup.incidence_amplitude\n\nThis should give\n\n-5.850900444651249e-8 - 3.80716581300155e-7im","category":"section"},{"location":"#Solving-the-inhomogeneous-radial-Teukolsky/SN-equation-with-a-point-particle-source-on-a-generic-timelike-bound-orbit","page":"Home","title":"Solving the inhomogeneous radial Teukolsky/SN equation with a point-particle source on a generic timelike bound orbit","text":"This can now be done easily with this code, starting from v0.7.0. Suppose we want to compute the inhomogeneous solution to the radial Teukolsky equation at infinity for the s = -2, ell = m = 2 mode driven by a test particle on a bound geodesic with aM = 09 p = 6M e = 07 x = cos(pi4), one can simply do\n\nmode_info = Teukolsky_pointparticle_mode(-2, 2, 2, 0, 0, 0.9, 6, 0.7, cos(Ï€/4))\n\nwhere n = 0 and k = 0 label the radial and polar modes, respectively. To have a glimpse of the output, one can do so with\n\njulia> mode_info\nTeukolskyPointParticleMode(\n    mode=Mode(s=-2, l=2, m=2, a=0.9, omega=0.06568724726732737, lambda=3.6067890121199833),\n    amplitude_inf=0.00023429507957491088 - 6.558414418883069e-5im,\n    energy_flux_inf=1.091733010828344e-6,\n    angular_momentum_flux_inf=3.3240333740438795e-5,\n    Carter_const_flux_inf=5.890504440487091e-5,\n)\n\nTo access for example the amplitude at infinity amplitude_inf\n\njulia> mode_info.amplitude_inf\n0.00023429507957491088 - 6.558414418883069e-5im\n\nwhich is the value for Z^infty_ell m n k, the amplitude of the inhomogeneous radial Teukolsky solution near infinity for that particular frequency.","category":"section"},{"location":"#How-to-cite","page":"Home","title":"How to cite","text":"If you have used this code in your research that leads to a publication, please cite the following article:\n\n@article{Lo:2023fvv,\n    author = \"Lo, Rico K. L.\",\n    title = \"{Recipes for computing radiation from a Kerr black hole using a generalized Sasaki-Nakamura formalism: Homogeneous solutions}\",\n    eprint = \"2306.16469\",\n    archivePrefix = \"arXiv\",\n    primaryClass = \"gr-qc\",\n    doi = \"10.1103/PhysRevD.110.124070\",\n    journal = \"Phys. Rev. D\",\n    volume = \"110\",\n    number = \"12\",\n    pages = \"124070\",\n    year = \"2024\"\n}\n\nAdditionally, if you have used this code's capability to solve for solutions with complex frequencies, please also cite the following article:\n\n@article{Lo:2025njp,\n    author = \"Lo, Rico K. L. and Sabani, Leart and Cardoso, Vitor\",\n    title = \"{Quasinormal modes and excitation factors of Kerr black holes}\",\n    eprint = \"2504.00084\",\n    archivePrefix = \"arXiv\",\n    primaryClass = \"gr-qc\",\n    doi = \"10.1103/PhysRevD.111.124002\",\n    journal = \"Phys. Rev. D\",\n    volume = \"111\",\n    number = \"12\",\n    pages = \"124002\",\n    year = \"2025\"\n}\n\nIf you have used this code's capability to solve for the gravitational waveform amplitude and fluxes at infinity with a test particle orbiting a Kerr black hole in a generic timelike bound and stable orbit (e.g., for extreme mass ratio inspiral waveforms), please cite the following article:\n\n@article{Yin:2025kls,\n    author = \"Yin, Yucheng and Lo, Rico K. L. and Chen, Xian\",\n    title = \"{Gravitational radiation from Kerr black holes using the Sasaki-Nakamura formalism: waveforms and fluxes at infinity}\",\n    eprint = \"2511.08673\",\n    archivePrefix = \"arXiv\",\n    primaryClass = \"gr-qc\",\n    month = \"11\",\n    year = \"2025\"\n}","category":"section"},{"location":"#License","page":"Home","title":"License","text":"The package is licensed under the MIT License.","category":"section"}]
}
